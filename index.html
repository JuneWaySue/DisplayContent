<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Display Content</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.28.0/themes/prism.min.css">
    <script src="https://cdn.jsdelivr.net/npm/pako@1.0.11/dist/pako.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.28.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.28.0/components/prism-python.min.js"></script>
</head>
<body>
    <h1>通过访问带content参数的本项目url来显示内容</h1>
    <pre><code id="content" class="language-python"></code></pre>
    <script>
        // 压缩字符串
        function compressString(str) {
            // 将字符串转换为Uint8Array
            var input = new TextEncoder().encode(str);
            // 使用pako进行压缩
            var compressed = pako.deflate(input);
            // 将压缩后的数据转换为Base64字符串
            var compressedBase64 = btoa(String.fromCharCode(...compressed));
            return compressedBase64;
        }

        // 解压缩字符串
        function decompressString(compressedBase64) {
            // 将Base64字符串转换为Uint8Array
            var compressed = Uint8Array.from(atob(compressedBase64), c => c.charCodeAt(0));
            // 使用pako进行解压缩
            var decompressed = pako.inflate(compressed);
            // 将Uint8Array转换回字符串
            var decompressedString = new TextDecoder().decode(decompressed);
            return decompressedString;
        }

        function getBase64ContentFromUrl(url) {
            // 使用正则表达式匹配 'content' 参数
            const regex = /(?:\?|&)(content=)([^&]+)/;
            const match = url.match(regex);
            if (match && match[2]) {
                // 将编码的 '+' 替换回原始的 '+'
                return match[2].replace(/%2B/g, '+');
            }
            return null; // 如果没有匹配到，返回 null
        }

        function getContentFromUrl() {
            const content = getBase64ContentFromUrl(window.location.search);
            if (content) {
                // 假设这是从Python端获取的Base64编码的压缩数据
                var base64EncodedCompressedData = content // 替换为您的Base64字符串

                // 输出解压后的数据
                document.getElementById('content').textContent = decompressString(base64EncodedCompressedData);
            }
        }

        // 当页面加载完毕后，获取并展示内容
        window.onload = getContentFromUrl;
    </script>
</body>
</html>
